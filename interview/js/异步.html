<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>理解异步 | Yolo</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="">
    <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/blog/assets/css/0.styles.671fbdd0.css" as="style"><link rel="preload" href="/blog/assets/js/app.1b73a34e.js" as="script"><link rel="preload" href="/blog/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/blog/assets/js/29.82ede666.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.302da1cf.js"><link rel="prefetch" href="/blog/assets/js/11.49cb5a17.js"><link rel="prefetch" href="/blog/assets/js/12.cc05ffa9.js"><link rel="prefetch" href="/blog/assets/js/13.bc6a6d00.js"><link rel="prefetch" href="/blog/assets/js/14.49df6a75.js"><link rel="prefetch" href="/blog/assets/js/15.672d9069.js"><link rel="prefetch" href="/blog/assets/js/16.8a0222c4.js"><link rel="prefetch" href="/blog/assets/js/17.d45e1d15.js"><link rel="prefetch" href="/blog/assets/js/18.670357ed.js"><link rel="prefetch" href="/blog/assets/js/19.8df598c5.js"><link rel="prefetch" href="/blog/assets/js/20.4493dfa7.js"><link rel="prefetch" href="/blog/assets/js/21.29efc0e0.js"><link rel="prefetch" href="/blog/assets/js/22.dee43871.js"><link rel="prefetch" href="/blog/assets/js/23.12c95ddc.js"><link rel="prefetch" href="/blog/assets/js/24.fc85ab8b.js"><link rel="prefetch" href="/blog/assets/js/25.d2553c7d.js"><link rel="prefetch" href="/blog/assets/js/26.13251b4e.js"><link rel="prefetch" href="/blog/assets/js/27.704b5b19.js"><link rel="prefetch" href="/blog/assets/js/28.073d1c04.js"><link rel="prefetch" href="/blog/assets/js/3.420c64ab.js"><link rel="prefetch" href="/blog/assets/js/30.4e4e5bbf.js"><link rel="prefetch" href="/blog/assets/js/31.7ac6d421.js"><link rel="prefetch" href="/blog/assets/js/32.1a06c393.js"><link rel="prefetch" href="/blog/assets/js/33.7eb5807c.js"><link rel="prefetch" href="/blog/assets/js/34.44b85fd5.js"><link rel="prefetch" href="/blog/assets/js/35.3bcdab5e.js"><link rel="prefetch" href="/blog/assets/js/36.4b30ada3.js"><link rel="prefetch" href="/blog/assets/js/37.372eef9f.js"><link rel="prefetch" href="/blog/assets/js/38.eb5538b0.js"><link rel="prefetch" href="/blog/assets/js/39.615f174c.js"><link rel="prefetch" href="/blog/assets/js/4.d12742be.js"><link rel="prefetch" href="/blog/assets/js/40.b9313f5d.js"><link rel="prefetch" href="/blog/assets/js/41.9120b576.js"><link rel="prefetch" href="/blog/assets/js/42.f5a93f99.js"><link rel="prefetch" href="/blog/assets/js/43.12e57085.js"><link rel="prefetch" href="/blog/assets/js/44.5f50fa3f.js"><link rel="prefetch" href="/blog/assets/js/45.167bfe07.js"><link rel="prefetch" href="/blog/assets/js/46.2c467463.js"><link rel="prefetch" href="/blog/assets/js/47.d6509dea.js"><link rel="prefetch" href="/blog/assets/js/5.216cae74.js"><link rel="prefetch" href="/blog/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/blog/assets/js/7.9c9172a7.js"><link rel="prefetch" href="/blog/assets/js/8.c310a593.js"><link rel="prefetch" href="/blog/assets/js/9.d9b0c4aa.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.671fbdd0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Yolo</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/internet/计算机网络简史.html" class="nav-link">
  计网
</a></div><div class="nav-item"><a href="/blog/frame/" class="nav-link">
  框架
</a></div><div class="nav-item"><a href="/blog/utils/源码阅读.html" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="/blog/interview/vue/" class="nav-link">
  面试
</a></div> <a href="https://github.com/SetoInlandSea/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/internet/计算机网络简史.html" class="nav-link">
  计网
</a></div><div class="nav-item"><a href="/blog/frame/" class="nav-link">
  框架
</a></div><div class="nav-item"><a href="/blog/utils/源码阅读.html" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="/blog/interview/vue/" class="nav-link">
  面试
</a></div> <a href="https://github.com/SetoInlandSea/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>计网</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/internet/计算机网络简史.html" class="sidebar-link">计算机网络简史</a></li><li><a href="/blog/internet/OSI七层模型.html" class="sidebar-link">OSI七层模型</a></li><li><a href="/blog/internet/TCP_IP协议群.html" class="sidebar-link">TCP_IP协议群</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/frame/" class="sidebar-link">首页</a></li><li><a href="/blog/frame/vue/vue3.0项目工程环境.html" class="sidebar-link">vue3.0项目工程环境</a></li><li><a href="/blog/frame/vue/vue3.html" class="sidebar-link">vue3</a></li><li><a href="/blog/frame/vue/大文件上传.html" class="sidebar-link">大文件上传</a></li><li><a href="/blog/frame/react/" class="sidebar-link">react</a></li><li><a href="/blog/frame/other/nuxt.html" class="sidebar-link">nuxt</a></li><li><a href="/blog/frame/other/electron.html" class="sidebar-link">electron</a></li><li><a href="/blog/frame/常用的方法.html" class="sidebar-link">常用的方法</a></li><li><a href="/blog/frame/字符串技巧.html" class="sidebar-link">字符串技巧</a></li><li><a href="/blog/frame/黑魔法.html" class="sidebar-link">黑魔法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/utils/源码阅读.html" class="sidebar-link">源码阅读</a></li><li><a href="/blog/utils/Chrome debugger.html" class="sidebar-link">Chrome debugger</a></li><li><a href="/blog/utils/git.html" class="sidebar-link">git</a></li><li><a href="/blog/utils/Chrome扩展插件.html" class="sidebar-link">Chrome扩展插件</a></li><li><a href="/blog/utils/npm发布.html" class="sidebar-link">npm发布</a></li><li><a href="/blog/utils/shell.html" class="sidebar-link">shell</a></li><li><a href="/blog/utils/前端工具.html" class="sidebar-link">前端工具</a></li><li><a href="/blog/utils/webpack.html" class="sidebar-link">webpack</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>产品</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分享</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="理解异步"><a href="#理解异步" class="header-anchor">#</a> 理解异步</h2> <p>同步：调动之后得到结果 再干别的任务
异步：调用之后先不管结果，继续干别的任务
单线程的js怎么实现异步
<strong>通过浏览器内核多线程</strong>实现异步
<img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639127843393-4dad7d3d-f200-4cd7-bb43-d5aa02629fa1.png#clientId=u16033a17-c939-4&amp;from=paste&amp;height=446&amp;id=u21ceb755&amp;name=image.png&amp;originHeight=446&amp;originWidth=757&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=94160&amp;status=done&amp;style=none&amp;taskId=uce488b36-6e74-433d-a347-0b54a996701&amp;title=&amp;width=757" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639362199367-6dcb5232-27d2-4a7a-b317-047837e70827.png#clientId=uf4cc5483-b5ea-4&amp;from=paste&amp;height=472&amp;id=udd3f28f4&amp;name=image.png&amp;originHeight=472&amp;originWidth=1530&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=197086&amp;status=done&amp;style=none&amp;taskId=u8cc05f2a-94b8-4bd4-b503-edaf2c3bba9&amp;title=&amp;width=1530" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639362186891-1b5721e1-034e-4cbf-acde-a248870e8b3f.png#clientId=uf4cc5483-b5ea-4&amp;from=paste&amp;height=603&amp;id=u427fe98c&amp;name=image.png&amp;originHeight=603&amp;originWidth=1067&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=81910&amp;status=done&amp;style=none&amp;taskId=uba681d02-e1ae-4df9-892d-2be13cd38e3&amp;title=&amp;width=1067" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639362527235-7e2e0128-7e31-4d42-b333-3c98dbb4a10d.png#clientId=uf4cc5483-b5ea-4&amp;from=paste&amp;height=272&amp;id=u50b9ea16&amp;name=image.png&amp;originHeight=272&amp;originWidth=878&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=53220&amp;status=done&amp;style=none&amp;taskId=u7e620942-1573-4d52-bb72-5606b3444e8&amp;title=&amp;width=878" alt="image.png"></p> <h2 id="预习资料"><a href="#预习资料" class="header-anchor">#</a> 预习资料</h2> <p><strong>《3.1-理解异步》预习资料</strong></p> <table><thead><tr><th><strong>预习资料名称</strong></th> <th><strong>链接</strong></th> <th><strong>备注</strong></th></tr></thead> <tbody><tr><td>官方图解：Chrome 快是有原因的，现代浏览器的多进程架构！</td> <td><a href="https://juejin.im/post/5bd7c761518825292d6b0217" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5bd7c761518825292d6b0217<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>学习这篇文章可以了解浏览器的架构以及每个模块负责的工作，宏观上了解浏览器的工作原理。</td></tr> <tr><td>进程与线程的一个简单解释</td> <td><a href="https://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html" target="_blank" rel="noopener noreferrer">https://www.ruanyifeng.com/blog/2013/04/processes_and_threads.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>文章生动形象的比喻了进程和线程，将抽象的概念形象化了</td></tr> <tr><td>浏览器进程？线程？傻傻分不清楚！</td> <td><a href="https://imweb.io/topic/58e3bfa845e5c13468f567d5" target="_blank" rel="noopener noreferrer">https://imweb.io/topic/58e3bfa845e5c13468f567d5<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>重点讲解线程、进程的区别，以及浏览器内核的多线程</td></tr> <tr><td>定时器标准</td> <td><a href="https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers" target="_blank" rel="noopener noreferrer">https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td></td></tr> <tr><td>规范对定时器的说明</td> <td></td> <td></td></tr></tbody></table> <p><strong>《3.2-Event Loop机制》预习资料</strong></p> <table><thead><tr><th><strong>预习资料名称</strong></th> <th><strong>链接</strong></th> <th><strong>备注</strong></th></tr></thead> <tbody><tr><td>Event Loops标准</td> <td><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loops" target="_blank" rel="noopener noreferrer">https://html.spec.whatwg.org/multipage/webappapis.html#event-loops<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td></td></tr> <tr><td>标准对Event Loops的说明</td> <td></td> <td></td></tr> <tr><td>Node.js 事件循环，定时器和 process.nextTick()</td> <td><a href="https://nodejs.org/zh-cn/docs/guides/event-loop-timers-and-nexttick/#what-is-the-event-loop" target="_blank" rel="noopener noreferrer">https://nodejs.org/zh-cn/docs/guides/event-loop-timers-and-nexttick/#what-is-the-event-loop<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>介绍了nodejs的事件循环和定时器</td></tr> <tr><td>调用栈</td> <td><a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Call_stack" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Glossary/Call_stack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>介绍js运行调用栈</td></tr> <tr><td>JS中的栈内存堆内存</td> <td><a href="https://juejin.im/post/5d116a9df265da1bb47d717b" target="_blank" rel="noopener noreferrer">https://juejin.im/post/5d116a9df265da1bb47d717b<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td></td></tr> <tr><td></td> <td></td> <td></td></tr></tbody></table> <p><strong>《3.4-深入理解promise》预习资料</strong></p> <table><thead><tr><th><strong>预习资料名称</strong></th> <th><strong>链接</strong></th> <th><strong>备注</strong></th></tr></thead> <tbody><tr><td>promise 基础</td> <td><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>无</td></tr> <tr><td>promises A+规范</td> <td><a href="https://github.com/promises-aplus/promises-spec" target="_blank" rel="noopener noreferrer">https://github.com/promises-aplus/promises-spec<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>无</td></tr> <tr><td>promises A+规范测试工具用例工具</td> <td><a href="https://github.com/promises-aplus/promises-tests" target="_blank" rel="noopener noreferrer">https://github.com/promises-aplus/promises-tests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>无</td></tr></tbody></table> <p>常见的Promise面试题，请同学们结合课程内容思考：</p> <ol><li>什么场景下需要使用promise？promise解决了什么问题？promise是如何解决问题的？</li> <li>promise有哪些常用方法，作用是什么？</li> <li>如果浏览器不知道promise应该如何处理？实现一个简单的promise polyfill。</li> <li>给定一段代码，给出代码打印的顺序。</li></ol> <p><strong>《3.5-Generator函数及其异步的应用》预习资料</strong></p> <table><thead><tr><th><strong>预习资料名称</strong></th> <th><strong>链接</strong></th> <th><strong>备注</strong></th></tr></thead> <tbody><tr><td>可迭代协议 迭代器协议</td> <td><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols#%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols#%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%8D%8F%E8%AE%AE<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>介绍可迭代协议和迭代器协议</td></tr> <tr><td>协程</td> <td><a href="https://cnodejs.org/topic/58ddd7a303d476b42d34c911" target="_blank" rel="noopener noreferrer">https://cnodejs.org/topic/58ddd7a303d476b42d34c911<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>介绍协程</td></tr> <tr><td>co源码</td> <td><a href="https://github.com/tj/co" target="_blank" rel="noopener noreferrer">https://github.com/tj/co<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>课后作业分析的源码</td></tr></tbody></table> <h2 id="异步编程方法"><a href="#异步编程方法" class="header-anchor">#</a> 异步编程方法</h2> <h3 id="_1-回调函数"><a href="#_1-回调函数" class="header-anchor">#</a> 1. 回调函数</h3> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639462300554-90bac9d9-19d8-410e-be18-f34e3fd77991.png#clientId=u4365d844-a2a8-4&amp;from=paste&amp;height=766&amp;id=ud4642758&amp;name=image.png&amp;originHeight=766&amp;originWidth=1070&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=253589&amp;status=done&amp;style=none&amp;taskId=u0df7295b-323e-4c02-9e73-b6b3b55eb44&amp;title=&amp;width=1070" alt="image.png"></p> <h3 id="_2-发布订阅"><a href="#_2-发布订阅" class="header-anchor">#</a> 2. 发布订阅</h3> <p>在promise出现之前的最优异步解决方案
<img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639462308566-67cc789b-8686-45cd-a16d-e3334c339dc9.png#clientId=u4365d844-a2a8-4&amp;from=paste&amp;height=974&amp;id=u3b22dc10&amp;name=image.png&amp;originHeight=974&amp;originWidth=902&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=400996&amp;status=done&amp;style=none&amp;taskId=u3465707b-c399-4149-b6ad-8261d4cb000&amp;title=&amp;width=902" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639462789683-1721ffe9-d0ef-4781-911f-fb61c256ea5a.png#clientId=u4365d844-a2a8-4&amp;from=paste&amp;height=1792&amp;id=ufe2ee626&amp;name=image.png&amp;originHeight=1792&amp;originWidth=1814&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=818924&amp;status=done&amp;style=none&amp;taskId=uaa9b8074-995e-43c2-bb83-64f02e4cc8e&amp;title=&amp;width=1814" alt="image.png"></p> <ul><li>优点 松耦合 灵活</li> <li>缺点 无法确保是否被触发 或者不知道触发几次</li></ul> <h5 id="nodejs发布订阅"><a href="#nodejs发布订阅" class="header-anchor">#</a> nodejs发布订阅</h5> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639462983888-7bea51a6-3aa7-47bc-826d-d798b4224063.png#clientId=u4365d844-a2a8-4&amp;from=paste&amp;height=714&amp;id=ua7690e94&amp;name=image.png&amp;originHeight=714&amp;originWidth=1534&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=277885&amp;status=done&amp;style=none&amp;taskId=ua09e9584-6190-4a48-90bc-2a94dc2356a&amp;title=&amp;width=1534" alt="image.png"></p> <h3 id="_3-promise"><a href="#_3-promise" class="header-anchor">#</a> 3. promise</h3> <h4 id="规范promise-a-要求"><a href="#规范promise-a-要求" class="header-anchor">#</a> 规范promise/A+ 要求</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639463566894-2510ab7f-01ec-4a82-9793-ce9f53260617.png#clientId=u4365d844-a2a8-4&amp;from=paste&amp;height=602&amp;id=u33dc8aa4&amp;name=image.png&amp;originHeight=602&amp;originWidth=1660&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=301031&amp;status=done&amp;style=none&amp;taskId=u259c0039-e107-48f0-92d0-a792acb5f03&amp;title=&amp;width=1660" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639463617733-e7114388-6de4-43eb-bb58-82b23d0a1692.png#clientId=u4365d844-a2a8-4&amp;from=paste&amp;height=698&amp;id=ubef7b514&amp;name=image.png&amp;originHeight=698&amp;originWidth=1948&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=223982&amp;status=done&amp;style=none&amp;taskId=u84802215-50e7-4d05-9b99-c7e2ba51a2b&amp;title=&amp;width=1948" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639463877182-829498cf-b37a-4c55-a1a4-e7378e41f8ab.png#clientId=u4365d844-a2a8-4&amp;from=paste&amp;height=1038&amp;id=ufc62dde5&amp;name=image.png&amp;originHeight=1038&amp;originWidth=2132&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=583461&amp;status=done&amp;style=none&amp;taskId=ucff6b438-ccf9-4a2e-b1a7-476f06b63c8&amp;title=&amp;width=2132" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639464023963-8a33082c-371b-4135-aa1b-c114b0624664.png#clientId=u4365d844-a2a8-4&amp;from=paste&amp;height=738&amp;id=u5e847c3b&amp;name=image.png&amp;originHeight=738&amp;originWidth=938&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=222020&amp;status=done&amp;style=none&amp;taskId=u1d39d2a3-b133-4f04-86a8-2772a8ea416&amp;title=&amp;width=938" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639464567010-869e5d7c-7980-4e80-8bd3-5f120991a6e6.png#clientId=u2cca9064-3c9a-4&amp;from=paste&amp;height=252&amp;id=u7311a62a&amp;name=image.png&amp;originHeight=252&amp;originWidth=1200&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=161305&amp;status=done&amp;style=none&amp;taskId=u2927d994-3854-482a-8f60-3f962de525a&amp;title=&amp;width=1200" alt="image.png"></p> <h4 id="es6-promise"><a href="#es6-promise" class="header-anchor">#</a> ES6 Promise</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639464802538-c962de68-994c-4fe7-be39-14bf7bbfd9b2.png#clientId=u80414359-bb0b-4&amp;from=paste&amp;height=966&amp;id=u5c24e99c&amp;name=image.png&amp;originHeight=966&amp;originWidth=2020&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=717754&amp;status=done&amp;style=none&amp;taskId=ue5944408-85ae-49f9-ab0a-5ba2854f752&amp;title=&amp;width=2020" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639464948486-d30cb6bc-7ffe-4bca-bdc2-c476639ad132.png#clientId=u6bb1dd60-c52d-4&amp;from=paste&amp;height=902&amp;id=u080077d5&amp;name=image.png&amp;originHeight=902&amp;originWidth=1874&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=514384&amp;status=done&amp;style=none&amp;taskId=u09d1db76-b453-4eed-b079-f60bb60bd9c&amp;title=&amp;width=1874" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1639465013777-c9e27e4f-fe7b-465e-9759-17354e4f1eec.png#clientId=u6bb1dd60-c52d-4&amp;from=paste&amp;height=550&amp;id=u4c19d02b&amp;name=image.png&amp;originHeight=550&amp;originWidth=1474&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=207927&amp;status=done&amp;style=none&amp;taskId=u97546959-434d-4ed2-950a-03b22030804&amp;title=&amp;width=1474" alt="image.png">
最佳实践</p> <ul><li>不要忘记catch捕捉错误</li> <li>then方法中使用return  （希望下一个promise接受到上一个promise的值）</li> <li>传递函数给then方法  （then接受非函数作为参数 会被忽略 见promiseA+规范）</li> <li>不要把嵌套promise （promise就是解决回调地狱）</li></ul> <h3 id="_4-generator"><a href="#_4-generator" class="header-anchor">#</a> 4. generator</h3> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640656951960-9c603ff5-547d-4245-b32a-396116d1cdb4.png#clientId=u6cbd7856-3d3b-4&amp;from=paste&amp;height=1088&amp;id=u523a6ef3&amp;name=image.png&amp;originHeight=1088&amp;originWidth=2130&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=589320&amp;status=done&amp;style=none&amp;taskId=u714065e9-8225-48c1-b861-1c6eda9eb52&amp;title=&amp;width=2130" alt="image.png"></p> <h4 id="es5迭代器"><a href="#es5迭代器" class="header-anchor">#</a> es5迭代器</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// es5迭代器</span>
<span class="token keyword">function</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token parameter">items</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> done <span class="token operator">=</span> i <span class="token operator">&gt;=</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
            <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token operator">!</span>done <span class="token operator">?</span> items<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">done</span><span class="token operator">:</span> done<span class="token punctuation">,</span>
                <span class="token literal-property property">value</span><span class="token operator">:</span> value
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> iterator <span class="token operator">=</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  { value: 1, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  { value: 2, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  { value: 3, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  { value: undefined, done: true }</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640656968330-a18b3c3e-c3b6-4123-b9d1-6a0e535424a5.png#clientId=u6cbd7856-3d3b-4&amp;from=paste&amp;height=904&amp;id=ub4b6b640&amp;name=image.png&amp;originHeight=904&amp;originWidth=1938&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=247610&amp;status=done&amp;style=none&amp;taskId=uf9410fe0-b4a4-486f-b00e-519683cb77c&amp;title=&amp;width=1938" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640657181043-4154ef58-49f2-45ef-946d-bc1bb25cf4ff.png#clientId=u39e8bba9-205d-4&amp;from=paste&amp;height=878&amp;id=u2f6ab9ef&amp;name=image.png&amp;originHeight=878&amp;originWidth=2144&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=405190&amp;status=done&amp;style=none&amp;taskId=u2c3b220d-7f9c-4407-87af-9000c886656&amp;title=&amp;width=2144" alt="image.png"></p> <h4 id="yield"><a href="#yield" class="header-anchor">#</a> yield</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640657308101-15bc8e4b-74c6-4437-b44a-8e658bc75393.png#clientId=u5765adbb-af5f-4&amp;from=paste&amp;height=904&amp;id=ua506a002&amp;name=image.png&amp;originHeight=904&amp;originWidth=1880&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=511565&amp;status=done&amp;style=none&amp;taskId=u5e568dc0-ca5c-4ce5-a7e2-96bb97ebd99&amp;title=&amp;width=1880" alt="image.png"></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> second <span class="token operator">=</span> <span class="token keyword">yield</span> first <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> second <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> iterator <span class="token operator">=</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  { value: 1, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  { value: 6, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  { value: 8, done: false }</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//  { value: undefined, done: true }</span>
</code></pre></div><h4 id="yield-2"><a href="#yield-2" class="header-anchor">#</a> yield*</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640658676123-73a9e043-d53d-49d6-84bd-4e126c0a0704.png#clientId=u03178e9a-0d9d-4&amp;from=paste&amp;height=1100&amp;id=u3b1e836d&amp;name=image.png&amp;originHeight=1100&amp;originWidth=2048&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=611610&amp;status=done&amp;style=none&amp;taskId=u9ccadd02-4150-4ba8-a6ba-5a4e831f17f&amp;title=&amp;width=2048" alt="image.png"></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">generator1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">generator2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">100</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span><span class="token operator">*</span> <span class="token function">generator1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> g2 <span class="token operator">=</span> <span class="token function">generator2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g2<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="return"><a href="#return" class="header-anchor">#</a> return</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> iterator <span class="token operator">=</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">return</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="throw"><a href="#throw" class="header-anchor">#</a> throw</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640658925332-dd9924df-7885-426e-955b-bd6d19900818.png#clientId=u03178e9a-0d9d-4&amp;from=paste&amp;height=1128&amp;id=u750ea03d&amp;name=image.png&amp;originHeight=1128&amp;originWidth=2096&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=648932&amp;status=done&amp;style=none&amp;taskId=uf8a55707-273d-45c1-b288-0c30fa835b6&amp;title=&amp;width=2096" alt="image.png"></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> first <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> second<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        second <span class="token operator">=</span> <span class="token keyword">yield</span> first <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        second <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">yield</span> second <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> iterator <span class="token operator">=</span> <span class="token function">createIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640658991697-f2445c35-2c7e-460e-9b5e-8e1d6d808a6a.png#clientId=u03178e9a-0d9d-4&amp;from=paste&amp;height=658&amp;id=E8vzj&amp;name=image.png&amp;originHeight=658&amp;originWidth=1450&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=245347&amp;status=done&amp;style=none&amp;taskId=ucdbff1d1-dc71-4482-9f34-726888f2d90&amp;title=&amp;width=1450" alt="image.png"></p> <h4 id="thunk函数"><a href="#thunk函数" class="header-anchor">#</a> Thunk函数</h4> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640660503711-e2e162f4-e6e1-4922-b4b3-fe355a0a8b09.png#clientId=ub1af3e8f-3595-4&amp;from=paste&amp;height=612&amp;id=u461fb6ae&amp;name=image.png&amp;originHeight=612&amp;originWidth=1216&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=194192&amp;status=done&amp;style=none&amp;taskId=u580f65b2-7574-4dba-8348-08e34e533ee&amp;title=&amp;width=1216" alt="image.png"></p> <h4 id="co模块源码分析"><a href="#co模块源码分析" class="header-anchor">#</a> co模块源码分析</h4> <h3 id="_5-async"><a href="#_5-async" class="header-anchor">#</a> 5. async</h3> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640662682485-a54e459e-1ab4-42e8-b66b-ea3ed337bbe7.png#clientId=ud17c0a93-609c-4&amp;from=paste&amp;height=632&amp;id=u0eae8a0d&amp;name=image.png&amp;originHeight=632&amp;originWidth=1404&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=253361&amp;status=done&amp;style=none&amp;taskId=ub18436c0-8757-463d-bab8-c220564022a&amp;title=&amp;width=1404" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640662897370-911c6ec3-ce8b-445c-b4c6-c4aa3a9e7917.png#clientId=ud17c0a93-609c-4&amp;from=paste&amp;height=1034&amp;id=u04398d26&amp;name=image.png&amp;originHeight=1034&amp;originWidth=2042&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=490490&amp;status=done&amp;style=none&amp;taskId=uce1e0976-18d3-41d8-8cf6-5955af888e4&amp;title=&amp;width=2042" alt="image.png"></p> <p>原理： generator 自动执行器</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">spawn</span><span class="token punctuation">(</span><span class="token parameter">genF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> gen <span class="token operator">=</span> <span class="token function">genF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">function</span> <span class="token function">step</span><span class="token punctuation">(</span><span class="token parameter">nextF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> next<span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                next <span class="token operator">=</span> <span class="token function">nextF</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>next<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">resolve</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
                <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">step</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">step</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> gen<span class="token punctuation">.</span><span class="token function">throw</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">step</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-示例"><a href="#_6-示例" class="header-anchor">#</a> 6. 示例</h3> <p>顺序读取文件</p> <h4 id="callback"><a href="#callback" class="header-anchor">#</a> callback</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// CALLBACK</span>
<span class="token keyword">function</span> <span class="token function">readFilesByCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/1.json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/2.json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/3.json&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">readFilesByCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="generator"><a href="#generator" class="header-anchor">#</a> generator</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// generator</span>
<span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">readFilesByGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/1.json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/2.json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/3.json&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> fileStr <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token parameter">filename</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            f<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">yield</span> <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">yield</span> <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> f <span class="token operator">=</span> <span class="token function">readFilesByGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

f<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h6 id="thunk函数-2"><a href="#thunk函数-2" class="header-anchor">#</a> Thunk函数</h6> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/292785/1640660503711-e2e162f4-e6e1-4922-b4b3-fe355a0a8b09.png#clientId=ub1af3e8f-3595-4&amp;from=paste&amp;height=612&amp;id=zj7dx&amp;name=image.png&amp;originHeight=612&amp;originWidth=1216&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=194192&amp;status=done&amp;style=none&amp;taskId=u580f65b2-7574-4dba-8348-08e34e533ee&amp;title=&amp;width=1216" alt="image.png"></p> <h4 id="generator-自动执行器"><a href="#generator-自动执行器" class="header-anchor">#</a> generator 自动执行器</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// generator 自动执行器</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">Thunk</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> readFileThunk <span class="token operator">=</span> <span class="token function">Thunk</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span>readFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> gen <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> gen<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>done<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    result<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">g</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">readFileThunk</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/kitty/testgenerator/1.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> s2 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">readFileThunk</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/kitty/testgenerator/2.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">readFileThunk</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/kitty/testgenerator/3.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s3<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">run</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="promise"><a href="#promise" class="header-anchor">#</a> promise</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// promise</span>
<span class="token keyword">function</span> <span class="token function">readFilesByPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/1.json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/2.json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/3.json&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">readFile</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 调用</span>
<span class="token function">readFilesByPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="async"><a href="#async" class="header-anchor">#</a> async</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// async</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">readFilesByAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/1.json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/2.json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;/Users/kitty/testgenerator/3.json&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">readFile</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> str0 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str0<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> str1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> str2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 调用</span>
<span class="token function">readFilesByAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_7-手写promise"><a href="#_7-手写promise" class="header-anchor">#</a> 7. 手写promise</h3> <ul><li>了解promise规范</li> <li>实现</li> <li>测试</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/SetoInlandSea/blog/edit/docs/docs/interview/js/异步.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.1b73a34e.js" defer></script><script src="/blog/assets/js/2.733019b2.js" defer></script><script src="/blog/assets/js/29.82ede666.js" defer></script>
  </body>
</html>
